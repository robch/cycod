# Test log file template variables
# Tests various template variable formats: {ProgramName}, {Time}, {TimeStamp} and case variations

class: log-template-variable-tests
tags: [cycodmd, logger]
tests:

- name: Test ProgramName template variable (uppercase P) for cycodmd
  steps:
  - name: Run cycodmd with {ProgramName} template and verify
    bash: |
      cycodmd version --log "test-{ProgramName}-log.log"
      cycodmd test-cycodmd-log.log exception-test-cycodmd-log.log
    expect-regex: |
      Version:
      test-cycodmd-log\.log
      File logger initialized with file:
      Memory logger configured to dump to
      exception-test-cycodmd-log\.log
      Logging system fully initialized
    not-expect-regex: |
      ## exception-test-cycodmd-log\.log

  - name: Clean up test log files
    bash: |
      rm -f test-*-log.log test-*-combined.log exception-test-*-log.log exception-test-*-combined.log
      echo "Cleanup completed"
    expect-regex: |
      Cleanup completed

- name: Test programName template variable (lowercase p) for cycodmd
  steps:
  - name: Run cycodmd with {programName} template and verify
    bash: |
      cycodmd version --log "test-{programName}-log.log"
      cycodmd test-cycodmd-log.log exception-test-cycodmd-log.log
    expect-regex: |
      Version:
      test-cycodmd-log\.log
      File logger initialized with file:
      Memory logger configured to dump to
      exception-test-cycodmd-log\.log
      Logging system fully initialized
    not-expect-regex: |
      ## exception-test-cycodmd-log\.log

  - name: Clean up test log files
    bash: |
      rm -f test-*-log.log test-*-combined.log exception-test-*-log.log exception-test-*-combined.log
      echo "Cleanup completed"
    expect-regex: |
      Cleanup completed

- name: Test Time template variable (uppercase T) for cycodmd
  steps:
  - name: Run cycodmd with {Time} template and verify
    bash: |
      cycodmd version --log "test-{Time}-log.log"
      cycodmd test-*-log.log exception-test-*-log.log
    expect-regex: |
      Version:
      test-[0-9]+-log\.log
      File logger initialized with file:
      Memory logger configured to dump to
      exception-test-[0-9]+-log\.log
      Logging system fully initialized
    not-expect-regex: |
      ## exception-test-.*-log\.log

  - name: Clean up test log files
    bash: |
      rm -f test-*-log.log test-*-combined.log exception-test-*-log.log exception-test-*-combined.log
      echo "Cleanup completed"
    expect-regex: |
      Cleanup completed

- name: Test time template variable (lowercase t) for cycodmd
  steps:
  - name: Run cycodmd with {time} template and verify
    bash: |
      cycodmd version --log "test-{time}-log.log"
      cycodmd test-*-log.log exception-test-*-log.log
    expect-regex: |
      Version:
      test-[0-9]+-log\.log
      File logger initialized with file:
      Memory logger configured to dump to
      exception-test-[0-9]+-log\.log
      Logging system fully initialized
    not-expect-regex: |
      ## exception-test-.*-log\.log

  - name: Clean up test log files
    bash: |
      rm -f test-*-log.log test-*-combined.log exception-test-*-log.log exception-test-*-combined.log
      echo "Cleanup completed"
    expect-regex: |
      Cleanup completed

- name: Test TimeStamp template variable (uppercase T and S) for cycodmd
  steps:
  - name: Run cycodmd with {TimeStamp} template and verify
    bash: |
      cycodmd version --log "test-{TimeStamp}-log.log"
      cycodmd test-*-log.log exception-test-*-log.log
    expect-regex: |
      Version:
      test-[0-9]+-log\.log
      File logger initialized with file:
      Memory logger configured to dump to
      exception-test-[0-9]+-log\.log
      Logging system fully initialized
    not-expect-regex: |
      ## exception-test-.*-log\.log

  - name: Clean up test log files
    bash: |
      rm -f test-*-log.log test-*-combined.log exception-test-*-log.log exception-test-*-combined.log
      echo "Cleanup completed"
    expect-regex: |
      Cleanup completed

- name: Test timestamp template variable (lowercase t and s) for cycodmd
  steps:
  - name: Run cycodmd with {timestamp} template and verify
    bash: |
      cycodmd version --log "test-{timestamp}-log.log"
      cycodmd test-*-log.log exception-test-*-log.log
    expect-regex: |
      Version:
      test-[0-9]+-log\.log
      File logger initialized with file:
      Memory logger configured to dump to
      exception-test-[0-9]+-log\.log
      Logging system fully initialized
    not-expect-regex: |
      ## exception-test-.*-log\.log

  - name: Clean up test log files
    bash: |
      rm -f test-*-log.log test-*-combined.log exception-test-*-log.log exception-test-*-combined.log
      echo "Cleanup completed"
    expect-regex: |
      Cleanup completed

- name: Test combined template variables for cycodmd
  steps:
  - name: Run cycodmd with multiple template variables and verify
    bash: |
      cycodmd version --log "test-{ProgramName}-{time}-combined.log"
      cycodmd test-cycodmd-*-combined.log exception-test-cycodmd-*-combined.log
    expect-regex: |
      Version:
      test-cycodmd-[0-9]+-combined\.log
      File logger initialized with file:
      Memory logger configured to dump to
      exception-test-cycodmd-[0-9]+-combined\.log
      Logging system fully initialized
    not-expect-regex: |
      ## exception-test-cycodmd-.*-combined\.log

  - name: Clean up test log files
    bash: |
      rm -f test-*-log.log test-*-combined.log exception-test-*-log.log exception-test-*-combined.log
      echo "Cleanup completed"
    expect-regex: |
      Cleanup completed