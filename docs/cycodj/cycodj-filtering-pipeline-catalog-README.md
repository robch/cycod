# cycodj CLI Filtering Pipeline Catalog

## Overview

This directory contains a comprehensive, evidence-based catalog of the filtering pipeline patterns implemented in the **cycodj** CLI tool.

cycodj (Cycod Journal) is a command-line tool for managing, searching, and analyzing conversation history from cycod chat sessions.

## Command Structure

cycodj has **5 primary commands**:

1. **[list](#list-command)** - List conversations with filtering and preview
2. **[search](#search-command)** - Search within conversation content
3. **[show](#show-command)** - Display a single conversation in detail
4. **[branches](#branches-command)** - Visualize conversation branch trees
5. **[stats](#stats-command)** - Display statistics about conversations
6. **[cleanup](#cleanup-command)** - Clean up duplicate/empty/old conversations

Each command implements different subsets of the 9-layer filtering pipeline.

---

## Command Catalog Index

### List Command
Lists conversations with optional filtering, preview, and statistics.

- [Layer 1: Target Selection](./list/cycodj-list-filtering-pipeline-catalog-layer-1.md) - [(Proof)](./list/cycodj-list-filtering-pipeline-catalog-layer-1-proof.md)
- [Layer 2: Container Filtering](./list/cycodj-list-filtering-pipeline-catalog-layer-2.md) - [(Proof)](./list/cycodj-list-filtering-pipeline-catalog-layer-2-proof.md)
- [Layer 3: Content Filtering](./list/cycodj-list-filtering-pipeline-catalog-layer-3.md) - [(Proof)](./list/cycodj-list-filtering-pipeline-catalog-layer-3-proof.md)
- [Layer 4: Content Removal](./list/cycodj-list-filtering-pipeline-catalog-layer-4.md) - [(Proof)](./list/cycodj-list-filtering-pipeline-catalog-layer-4-proof.md)
- [Layer 5: Context Expansion](./list/cycodj-list-filtering-pipeline-catalog-layer-5.md) - [(Proof)](./list/cycodj-list-filtering-pipeline-catalog-layer-5-proof.md)
- [Layer 6: Display Control](./list/cycodj-list-filtering-pipeline-catalog-layer-6.md) - [(Proof)](./list/cycodj-list-filtering-pipeline-catalog-layer-6-proof.md)
- [Layer 7: Output Persistence](./list/cycodj-list-filtering-pipeline-catalog-layer-7.md) - [(Proof)](./list/cycodj-list-filtering-pipeline-catalog-layer-7-proof.md)
- [Layer 8: AI Processing](./list/cycodj-list-filtering-pipeline-catalog-layer-8.md) - [(Proof)](./list/cycodj-list-filtering-pipeline-catalog-layer-8-proof.md)
- [Layer 9: Actions on Results](./list/cycodj-list-filtering-pipeline-catalog-layer-9.md) - [(Proof)](./list/cycodj-list-filtering-pipeline-catalog-layer-9-proof.md)

### Search Command
Searches conversation content with pattern matching and context display.

- [Layer 1: Target Selection](./search/cycodj-search-filtering-pipeline-catalog-layer-1.md) - [(Proof)](./search/cycodj-search-filtering-pipeline-catalog-layer-1-proof.md)
- [Layer 2: Container Filtering](./search/cycodj-search-filtering-pipeline-catalog-layer-2.md) - [(Proof)](./search/cycodj-search-filtering-pipeline-catalog-layer-2-proof.md)
- [Layer 3: Content Filtering](./search/cycodj-search-filtering-pipeline-catalog-layer-3.md) - [(Proof)](./search/cycodj-search-filtering-pipeline-catalog-layer-3-proof.md)
- [Layer 4: Content Removal](./search/cycodj-search-filtering-pipeline-catalog-layer-4.md) - [(Proof)](./search/cycodj-search-filtering-pipeline-catalog-layer-4-proof.md)
- [Layer 5: Context Expansion](./search/cycodj-search-filtering-pipeline-catalog-layer-5.md) - [(Proof)](./search/cycodj-search-filtering-pipeline-catalog-layer-5-proof.md)
- [Layer 6: Display Control](./search/cycodj-search-filtering-pipeline-catalog-layer-6.md) - [(Proof)](./search/cycodj-search-filtering-pipeline-catalog-layer-6-proof.md)
- [Layer 7: Output Persistence](./search/cycodj-search-filtering-pipeline-catalog-layer-7.md) - [(Proof)](./search/cycodj-search-filtering-pipeline-catalog-layer-7-proof.md)
- [Layer 8: AI Processing](./search/cycodj-search-filtering-pipeline-catalog-layer-8.md) - [(Proof)](./search/cycodj-search-filtering-pipeline-catalog-layer-8-proof.md)
- [Layer 9: Actions on Results](./search/cycodj-search-filtering-pipeline-catalog-layer-9.md) - [(Proof)](./search/cycodj-search-filtering-pipeline-catalog-layer-9-proof.md)

### Show Command
Displays a single conversation with detailed message content.

- [Layer 1: Target Selection](./show/cycodj-show-filtering-pipeline-catalog-layer-1.md) - [(Proof)](./show/cycodj-show-filtering-pipeline-catalog-layer-1-proof.md)
- [Layer 2: Container Filtering](./show/cycodj-show-filtering-pipeline-catalog-layer-2.md) - [(Proof)](./show/cycodj-show-filtering-pipeline-catalog-layer-2-proof.md)
- [Layer 3: Content Filtering](./show/cycodj-show-filtering-pipeline-catalog-layer-3.md) - [(Proof)](./show/cycodj-show-filtering-pipeline-catalog-layer-3-proof.md)
- [Layer 4: Content Removal](./show/cycodj-show-filtering-pipeline-catalog-layer-4.md) - [(Proof)](./show/cycodj-show-filtering-pipeline-catalog-layer-4-proof.md)
- [Layer 5: Context Expansion](./show/cycodj-show-filtering-pipeline-catalog-layer-5.md) - [(Proof)](./show/cycodj-show-filtering-pipeline-catalog-layer-5-proof.md)
- [Layer 6: Display Control](./show/cycodj-show-filtering-pipeline-catalog-layer-6.md) - [(Proof)](./show/cycodj-show-filtering-pipeline-catalog-layer-6-proof.md)
- [Layer 7: Output Persistence](./show/cycodj-show-filtering-pipeline-catalog-layer-7.md) - [(Proof)](./show/cycodj-show-filtering-pipeline-catalog-layer-7-proof.md)
- [Layer 8: AI Processing](./show/cycodj-show-filtering-pipeline-catalog-layer-8.md) - [(Proof)](./show/cycodj-show-filtering-pipeline-catalog-layer-8-proof.md)
- [Layer 9: Actions on Results](./show/cycodj-show-filtering-pipeline-catalog-layer-9.md) - [(Proof)](./show/cycodj-show-filtering-pipeline-catalog-layer-9-proof.md)

### Branches Command
Visualizes conversation branching structure and relationships.

- [Layer 1: Target Selection](./branches/cycodj-branches-filtering-pipeline-catalog-layer-1.md) - [(Proof)](./branches/cycodj-branches-filtering-pipeline-catalog-layer-1-proof.md)
- [Layer 2: Container Filtering](./branches/cycodj-branches-filtering-pipeline-catalog-layer-2.md) - [(Proof)](./branches/cycodj-branches-filtering-pipeline-catalog-layer-2-proof.md)
- [Layer 3: Content Filtering](./branches/cycodj-branches-filtering-pipeline-catalog-layer-3.md) - [(Proof)](./branches/cycodj-branches-filtering-pipeline-catalog-layer-3-proof.md)
- [Layer 4: Content Removal](./branches/cycodj-branches-filtering-pipeline-catalog-layer-4.md) - [(Proof)](./branches/cycodj-branches-filtering-pipeline-catalog-layer-4-proof.md)
- [Layer 5: Context Expansion](./branches/cycodj-branches-filtering-pipeline-catalog-layer-5.md) - [(Proof)](./branches/cycodj-branches-filtering-pipeline-catalog-layer-5-proof.md)
- [Layer 6: Display Control](./branches/cycodj-branches-filtering-pipeline-catalog-layer-6.md) - [(Proof)](./branches/cycodj-branches-filtering-pipeline-catalog-layer-6-proof.md)
- [Layer 7: Output Persistence](./branches/cycodj-branches-filtering-pipeline-catalog-layer-7.md) - [(Proof)](./branches/cycodj-branches-filtering-pipeline-catalog-layer-7-proof.md)
- [Layer 8: AI Processing](./branches/cycodj-branches-filtering-pipeline-catalog-layer-8.md) - [(Proof)](./branches/cycodj-branches-filtering-pipeline-catalog-layer-8-proof.md)
- [Layer 9: Actions on Results](./branches/cycodj-branches-filtering-pipeline-catalog-layer-9.md) - [(Proof)](./branches/cycodj-branches-filtering-pipeline-catalog-layer-9-proof.md)

### Stats Command
Displays statistics and analytics about conversation history.

- [Layer 1: Target Selection](./stats/cycodj-stats-filtering-pipeline-catalog-layer-1.md) - [(Proof)](./stats/cycodj-stats-filtering-pipeline-catalog-layer-1-proof.md)
- [Layer 2: Container Filtering](./stats/cycodj-stats-filtering-pipeline-catalog-layer-2.md) - [(Proof)](./stats/cycodj-stats-filtering-pipeline-catalog-layer-2-proof.md)
- [Layer 3: Content Filtering](./stats/cycodj-stats-filtering-pipeline-catalog-layer-3.md) - [(Proof)](./stats/cycodj-stats-filtering-pipeline-catalog-layer-3-proof.md)
- [Layer 4: Content Removal](./stats/cycodj-stats-filtering-pipeline-catalog-layer-4.md) - [(Proof)](./stats/cycodj-stats-filtering-pipeline-catalog-layer-4-proof.md)
- [Layer 5: Context Expansion](./stats/cycodj-stats-filtering-pipeline-catalog-layer-5.md) - [(Proof)](./stats/cycodj-stats-filtering-pipeline-catalog-layer-5-proof.md)
- [Layer 6: Display Control](./stats/cycodj-stats-filtering-pipeline-catalog-layer-6.md) - [(Proof)](./stats/cycodj-stats-filtering-pipeline-catalog-layer-6-proof.md)
- [Layer 7: Output Persistence](./stats/cycodj-stats-filtering-pipeline-catalog-layer-7.md) - [(Proof)](./stats/cycodj-stats-filtering-pipeline-catalog-layer-7-proof.md)
- [Layer 8: AI Processing](./stats/cycodj-stats-filtering-pipeline-catalog-layer-8.md) - [(Proof)](./stats/cycodj-stats-filtering-pipeline-catalog-layer-8-proof.md)
- [Layer 9: Actions on Results](./stats/cycodj-stats-filtering-pipeline-catalog-layer-9.md) - [(Proof)](./stats/cycodj-stats-filtering-pipeline-catalog-layer-9-proof.md)

### Cleanup Command
Manages conversation cleanup operations (duplicates, empty, old files).

- [Layer 1: Target Selection](./cleanup/cycodj-cleanup-filtering-pipeline-catalog-layer-1.md) - [(Proof)](./cleanup/cycodj-cleanup-filtering-pipeline-catalog-layer-1-proof.md)
- [Layer 2: Container Filtering](./cleanup/cycodj-cleanup-filtering-pipeline-catalog-layer-2.md) - [(Proof)](./cleanup/cycodj-cleanup-filtering-pipeline-catalog-layer-2-proof.md)
- [Layer 3: Content Filtering](./cleanup/cycodj-cleanup-filtering-pipeline-catalog-layer-3.md) - [(Proof)](./cleanup/cycodj-cleanup-filtering-pipeline-catalog-layer-3-proof.md)
- [Layer 4: Content Removal](./cleanup/cycodj-cleanup-filtering-pipeline-catalog-layer-4.md) - [(Proof)](./cleanup/cycodj-cleanup-filtering-pipeline-catalog-layer-4-proof.md)
- [Layer 5: Context Expansion](./cleanup/cycodj-cleanup-filtering-pipeline-catalog-layer-5.md) - [(Proof)](./cleanup/cycodj-cleanup-filtering-pipeline-catalog-layer-5-proof.md)
- [Layer 6: Display Control](./cleanup/cycodj-cleanup-filtering-pipeline-catalog-layer-6.md) - [(Proof)](./cleanup/cycodj-cleanup-filtering-pipeline-catalog-layer-6-proof.md)
- [Layer 7: Output Persistence](./cleanup/cycodj-cleanup-filtering-pipeline-catalog-layer-7.md) - [(Proof)](./cleanup/cycodj-cleanup-filtering-pipeline-catalog-layer-7-proof.md)
- [Layer 8: AI Processing](./cleanup/cycodj-cleanup-filtering-pipeline-catalog-layer-8.md) - [(Proof)](./cleanup/cycodj-cleanup-filtering-pipeline-catalog-layer-8-proof.md)
- [Layer 9: Actions on Results](./cleanup/cycodj-cleanup-filtering-pipeline-catalog-layer-9.md) - [(Proof)](./cleanup/cycodj-cleanup-filtering-pipeline-catalog-layer-9-proof.md)

---

## The 9-Layer Filtering Pipeline

Each command in cycodj flows through up to 9 conceptual layers:

1. **TARGET SELECTION** - What conversations to search/load (time-based, count-based)
2. **CONTAINER FILTERING** - Which conversations to include/exclude (specific IDs, date ranges)
3. **CONTENT FILTERING** - What content within conversations to show (message roles, search patterns)
4. **CONTENT REMOVAL** - What content to actively remove from display (N/A for most commands)
5. **CONTEXT EXPANSION** - How to expand around matches (context lines in search)
6. **DISPLAY CONTROL** - How to present results (formatting, stats, branches, message counts)
7. **OUTPUT PERSISTENCE** - Where to save results (files, formats)
8. **AI PROCESSING** - AI-assisted analysis of results (instructions, built-in functions)
9. **ACTIONS ON RESULTS** - What to do with results (cleanup operations)

---

## Source Code References

### Main Files
- **Parser**: `src/cycodj/CommandLine/CycoDjCommandLineOptions.cs`
- **Base Command**: `src/cycodj/CommandLine/CycoDjCommand.cs`
- **Commands**: `src/cycodj/CommandLineCommands/*.cs`
- **Helpers**: `src/cycodj/Helpers/*.cs`

### Key Components
- **Time Specification Parsing**: Uses `TimeSpecHelpers` (shared common code)
- **Conversation Reading**: `JsonlReader.cs`
- **Branch Detection**: `BranchDetector.cs`
- **History File Management**: `HistoryFileHelpers.cs`

---

## Catalog Methodology

Each layer document in this catalog contains:

1. **Feature Description**: What this layer does for the command
2. **CLI Options**: Command-line options that control this layer
3. **Implementation Summary**: High-level description of how it works
4. **Layer Flow**: How data flows through this layer

Each corresponding proof document contains:

1. **Parser Evidence**: Line numbers showing where options are parsed
2. **Property Evidence**: Where values are stored in command objects
3. **Execution Evidence**: Where and how the feature is implemented
4. **Data Flow**: Call stack and data transformations

This provides both **human-readable documentation** and **verifiable source code evidence** for every feature.
