# cycodt `run` Command - Filtering Pipeline Catalog

## Overview

The `run` command executes tests from YAML test files and produces test results in structured formats (TRX or JUnit XML).

**Command**: `cycodt run [options]`

## Purpose

Execute tests (or filtered subset) from YAML test files and generate test result reports.

## Layer Implementation Summary

| Layer | Implemented | Key Features |
|-------|-------------|--------------|
| 1. TARGET SELECTION | ✅ Yes | `--file`, `--files`, `--exclude`, `--test`, `--tests`, `--contains`, `--remove`, `--include-optional` |
| 2. CONTAINER FILTER | ✅ Yes | Test name filtering, optional category filtering |
| 3. CONTENT FILTER | ❌ No | N/A - executes tests |
| 4. CONTENT REMOVAL | ❌ No | N/A - executes tests |
| 5. CONTEXT EXPANSION | ❌ No | N/A - test execution context |
| 6. DISPLAY CONTROL | ✅ Yes | Console progress, colored output, failure summary |
| 7. OUTPUT PERSISTENCE | ✅ Full | `--output-file`, `--output-format` (trx, junit) |
| 8. AI PROCESSING | ❌ No | N/A |
| 9. ACTIONS ON RESULTS | ✅ Yes | Test execution |

## Layer Details

- **[Layer 1: Target Selection](cycodt-run-layer-1.md)** - [Proof](cycodt-run-layer-1-proof.md)
- **[Layer 2: Container Filter](cycodt-run-layer-2.md)** - [Proof](cycodt-run-layer-2-proof.md)
- **[Layer 3: Content Filter](cycodt-run-layer-3.md)** - [Proof](cycodt-run-layer-3-proof.md)
- **[Layer 4: Content Removal](cycodt-run-layer-4.md)** - [Proof](cycodt-run-layer-4-proof.md)
- **[Layer 5: Context Expansion](cycodt-run-layer-5.md)** - [Proof](cycodt-run-layer-5-proof.md)
- **[Layer 6: Display Control](cycodt-run-layer-6.md)** - [Proof](cycodt-run-layer-6-proof.md)
- **[Layer 7: Output Persistence](cycodt-run-layer-7.md)** - [Proof](cycodt-run-layer-7-proof.md)
- **[Layer 8: AI Processing](cycodt-run-layer-8.md)** - [Proof](cycodt-run-layer-8-proof.md)
- **[Layer 9: Actions on Results](cycodt-run-layer-9.md)** - [Proof](cycodt-run-layer-9-proof.md)

## Command Line Options

### Target Selection (Layer 1)
- `--file <pattern>` - Single test file pattern
- `--files <pattern1> <pattern2> ...` - Multiple test file patterns
- `--exclude <pattern>` / `--exclude-files <pattern>` - Exclude file patterns
- `--test <name>` - Specific test name
- `--tests <name1> <name2> ...` - Multiple test names
- `--contains <pattern>` - Include tests containing pattern
- `--remove <pattern>` - Remove tests matching pattern
- `--include-optional [category]` - Include optional tests (all or specific category)

### Output Persistence (Layer 7)
- `--output-file <path>` - Output file path (default: `test-results.{ext}`)
- `--output-format <format>` - Output format: `trx` (default) or `junit`

### Global Options
- `--debug` - Debug output
- `--verbose` - Verbose output
- `--quiet` - Suppress non-essential output

## Usage Examples

```bash
# Run all tests (default TRX output)
cycodt run

# Run tests with custom output file
cycodt run --output-file my-results.trx

# Run tests with JUnit format
cycodt run --output-format junit

# Run tests with custom file and format
cycodt run --output-file test-results.xml --output-format junit

# Run specific tests
cycodt run --test "my specific test"

# Run tests matching pattern
cycodt run --contains "database"

# Run tests from specific file
cycodt run --file tests/integration-tests.yaml
```

## Output Formats

### TRX (Visual Studio Test Results)
- XML format compatible with Visual Studio Test Explorer
- Default output: `test-results.trx`
- Generated by: `TrxXmlTestReporter`

### JUnit XML
- XML format compatible with JUnit test frameworks
- Default output: `test-results.xml`
- Generated by: `JunitXmlTestReporter`

## Console Output

The `run` command provides rich console output:

1. **Test Progress**: Real-time test status (Starting, Passed, Failed, Skipped)
2. **Colored Output**: Green (passed), Red (failed), Yellow (skipped)
3. **Failure Summary**: Detailed error messages and stack traces for failed tests
4. **Test Summary**: Statistics (passed/failed/skipped counts, percentages, duration)
5. **Results File Path**: Location of generated results file

## Source Code

**Primary Implementation**: `src/cycodt/CommandLineCommands/TestCommands/TestRunCommand.cs`

**Supporting Classes**:
- `TestBaseCommand.cs` - Base class with filtering logic
- `CycoDtCommandLineOptions.cs` - Command-line parsing
- `YamlTestFramework.cs` - Test execution
- `YamlTestFrameworkConsoleHost.cs` - Console output and reporter orchestration
- `TrxXmlTestReporter.cs` - TRX format generator
- `JunitXmlTestReporter.cs` - JUnit format generator
- `TestRun.cs` - Test run state management

## Related Commands

- **[list](cycodt-list-catalog-README.md)** - List available tests before running
- **[expect check](cycodt-expect-check-catalog-README.md)** - Verify test output expectations
- **[expect format](cycodt-expect-format-catalog-README.md)** - Format test expectations
